const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Ba8jslA9.js","assets/index-BMFXaNTE.js","assets/index-D6BXZ84r.css","assets/constant-D9aChVKe.js","assets/index-CoVqy9N1.js","assets/index-CotcSacm.css","assets/index-Cccog60T.js","assets/reactNode-DDDjn3xV.js","assets/index-DiYfHYWG.js","assets/ContextIsolator-CvJpvXKt.js","assets/expand-Biq-oZ1j.js","assets/index-Bmusikl4.css","assets/index-CsiBAcyk.js","assets/index-BMHXkvUh.css"])))=>i.map(i=>d[i]);
var R=Object.defineProperty;var U=(n,e,t)=>e in n?R(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var x=(n,e,t)=>U(n,typeof e!="symbol"?e+"":e,t);import{r as a,j as r,P as N,c as C,a as E,i as k,d as O,b as V,u as H,e as I,S as j,_ as B}from"./index-BMFXaNTE.js";import{a as v,b,u as F,L as q,g as T,c as W}from"./constant-D9aChVKe.js";const G=n=>a.createElement("svg",{t:1744432367236,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":4335,xmlnsXlink:"http://www.w3.org/1999/xlink",width:48,height:48,...n},a.createElement("path",{d:"M237.44 943.36H101.12a94.08 94.08 0 0 1-94.08-94.08v-135.68a94.08 94.08 0 0 1 94.08-94.72h136.32a94.08 94.08 0 0 1 94.08 94.72v135.68a94.08 94.08 0 0 1-94.08 94.08z m-136.32-261.12a31.36 31.36 0 0 0-31.36 31.36v135.68a31.36 31.36 0 0 0 31.36 31.36h136.32a30.72 30.72 0 0 0 30.72-31.36v-135.68a30.72 30.72 0 0 0-30.72-31.36zM579.84 943.36H444.16a94.08 94.08 0 0 1-94.08-94.08v-135.68a94.08 94.08 0 0 1 94.08-94.72h135.68a94.08 94.08 0 0 1 94.08 94.72v135.68a94.08 94.08 0 0 1-94.08 94.08z m-135.68-261.12a31.36 31.36 0 0 0-31.36 31.36v135.68a31.36 31.36 0 0 0 31.36 31.36h135.68a31.36 31.36 0 0 0 31.36-31.36v-135.68a31.36 31.36 0 0 0-31.36-31.36zM922.88 943.36h-136.32a94.08 94.08 0 0 1-94.08-94.08v-135.68a94.08 94.08 0 0 1 94.08-94.72h136.32a94.08 94.08 0 0 1 94.08 94.72v135.68a94.08 94.08 0 0 1-94.08 94.08z m-136.32-261.12a30.72 30.72 0 0 0-30.72 31.36v135.68a30.72 30.72 0 0 0 30.72 31.36h136.32a31.36 31.36 0 0 0 31.36-31.36v-135.68a31.36 31.36 0 0 0-31.36-31.36zM922.88 576H101.12A88.96 88.96 0 0 1 12.16 485.76V169.6a88.96 88.96 0 0 1 88.96-88.96h821.76a88.96 88.96 0 0 1 88.96 88.96v316.16A88.96 88.96 0 0 1 922.88 576zM101.12 133.12a36.48 36.48 0 0 0-37.12 36.48v316.16a36.48 36.48 0 0 0 36.48 36.48h822.4a36.48 36.48 0 0 0 37.12-36.48V169.6a36.48 36.48 0 0 0-36.48-36.48z",fill:"currentColor","p-id":4336})),Q=n=>a.createElement("svg",{t:1744433536480,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":5363,width:48,height:48,...n},a.createElement("path",{d:"M416.256 983.04c-117.76 0-217.088-37.376-288.256-108.544-69.632-69.632-108.032-168.448-108.032-278.528 0-206.336 167.424-373.76 324.608-425.984 67.072-22.528 135.68-33.28 205.312-32.256 19.968 0.512 35.328 16.384 35.328 36.352-0.512 19.968-14.848 35.84-36.352 35.328-61.44-1.024-122.368 8.704-181.76 28.672-135.68 45.056-275.968 191.488-275.968 358.4 0 90.624 30.72 171.52 87.552 227.84 56.832 56.832 139.264 87.04 237.568 87.04h0.512c243.712-0.512 320-124.416 322.56-141.824 0-5.632-13.312-24.064-20.992-34.816-26.624-37.376-76.288-106.496-6.144-181.76 73.728-79.872 150.016-57.344 195.584-44.544 7.68 2.56 15.872 4.608 22.528 6.144 6.144-23.04 1.024-92.672-59.904-165.888-12.8-15.36-10.24-37.888 4.608-50.176 15.36-12.288 37.888-10.24 50.176 4.608 75.776 91.648 91.648 195.584 67.584 246.272-11.264 23.552-30.72 37.376-53.76 37.376-16.896 0-33.28-4.608-51.2-9.728-43.008-12.288-79.872-23.04-123.904 24.576-28.16 30.208-19.456 48.128 11.776 91.648 16.896 23.552 34.304 48.128 34.304 77.312 0.512 60.416-116.736 211.968-393.728 212.48 0.512 0 0 0 0 0z",fill:"currentColor","p-id":5364}),a.createElement("path",{d:"M364.032 628.736c-30.208 0-49.664-9.728-57.856-28.16-6.656-15.36-3.072-32.768 9.216-46.592 24.064-25.6 26.624-45.568 30.208-68.096 3.584-24.064 7.68-53.76 37.376-81.408 39.936-37.376 103.936-32.768 148.992 9.728 25.088 23.552 38.912 52.224 38.912 81.408 0 24.576-9.728 47.104-28.672 64.512-53.76 50.176-136.192 68.608-178.176 68.608z m84.48-180.224c-6.656 0-12.8 2.56-17.408 7.168-11.264 10.752-12.8 19.456-15.872 40.448-2.56 15.872-6.144 43.008-24.576 64 39.936-4.096 97.792-29.696 107.52-57.856 3.072-8.704-3.072-27.136-13.824-36.864-11.776-10.752-24.576-16.896-35.84-16.896z m134.656-37.376c-8.192-20.48-20.48-30.208-40.448-39.936-19.456-9.728-23.552-27.136-23.552-27.136-3.072-11.776 0-24.064 8.192-34.304 12.8-16.384 24.576-31.744 50.688-56.32 17.92-16.896 252.928-217.088 312.32-217.088 0 0 17.92-3.584 31.744 14.848 8.192 10.752 8.192 24.576 8.192 24.576 0 61.44-230.4 293.376-232.96 295.936-25.6 24.064-47.616 44.032-68.608 54.272-31.232 15.36-45.568-14.848-45.568-14.848zM604.16 327.68c2.56 2.048 5.12 4.608 7.68 7.168l10.24 10.24c7.168-5.632 16.384-13.312 27.136-23.552 30.208-28.672 82.944-86.016 128-138.752-56.32 41.984-118.784 92.16-151.552 122.88-9.216 8.192-15.872 15.872-21.504 22.016z",fill:"currentColor","p-id":5365})),X="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAcNJREFUaEPtmT8vBVEQxX+vJ9FpFAqR6BX+NHwIPgAJFSEkStQIoSLhA/AhaNDQaCSiUGh0gh6TrGStl71n3tuN4s1NXl5xz5y7Z+bs3t07DfxjAJgHhoEJf/ifiDfgGrgDjoBHD2fDAwYWgH1njBe+CByoQR4Blu1zlbhN3OR3dS8UDlVAN3ADDAqkmyWLWxLWBY6HzKLvKawqwJP9KgTYdUtVUAWsANupbFQ8vwrspDhVARti6VPreeatkrZu6ehYAZI/U9krzBfvs1orEAKaVCcqUGbZ4lMoLBQWyjLQ6j4QFgoLhYXEDw7H60RsZLGROezSDBoWCguFhX6fO8UXWd4R8T0g3B/xGI3HqGCTMkhYqKMs1KZbpPBaNzLlCp5yjQ7zd78SlMNUKmAJ2HVeQPHE49MZvwzspWLUY5Ux4DJFlpu3bqN1MvPjEJhzcIwDVym8KqALuAf6UoTZvDXo7OwoP6xBqLZln4Eh4CO1nirAeGaA4xRhbt4s8IOfdVrQ8CfKWh4BxjcFnCrEGeY1++9xxEwDZyreK8B4e4E1YAQYVRcqwVkr9Tb7bQEvHs5WBHj4a8eGgNpTnFggKvDfFfgCqFqiMSJ6/lAAAAAASUVORK5CYII=",Y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAwCAYAAABNPhkJAAAAAXNSR0IArs4c6QAAAexJREFUaEPtmj0vBEEYx3/j1lur1UkoKEgIUQgqOYVar6LQ0Hq5aCR0coXCR6AkrqEQnIRCovMFfALBnnWzN3vGnbtrRjHrmeLuMnv75PnN7P+/kzyP4nv0BrAOzAAj1rzPP4vAVQh7wIsGUfojgK3y97bPZK1yb4Phd3hUHTD4CU+tbkjB9ZcQ+lQA+8CaBXQDFFIAqBHGgWzComBZA98CE2byLIT5lMDGGAFcA5OGaUcDRxZgLkyZloMKj/YoDXogwLLDngtaHmkxLXFpv0UsGhYNi4ZFw16tgJiWmJaYlleSrUtWNCwaFg2Lhr1aATEtMS0xLa8kKwcPMa3/aFqnVkmxqGDlAx78Vm4l+04YKMEJMGR4NnQxrVpdM5NvgK4Rp2HoMnC3VR9eSloeXoGuNBA2YSiEMBcDm60/NA0taeS+D2FMg8XAycjAIjClYPAPqHV3kB6XNbEbzbtI4S6CuxIcW4+1i7jNYwSVVqgL869ql0FQmUuAZ8P6xXCe3I8ddh7dBBRgc16XHZZH2r3IXGq4JwNZBf0N0oxbh8pvhpx1fdoyLX0A+i2f8/L709lByBlwO6xEkHe/J3F/1XwJzlzEdgacgbw+h7tIqjaGgtUPOHAR2yXwgoJNYNRFYkmMCI4C2H2DZxdxvwBWm/32ejOcxwAAAABJRU5ErkJggg==",K="_header_zv0jf_1",J="_left_zv0jf_6",Z="_middle_zv0jf_14",$="_icon_zv0jf_20",ee="_selected_zv0jf_31",ne="_right_zv0jf_39",w={header:K,left:J,middle:Z,icon:$,selected:ee,right:ne},te=[{type:N.pc,icon:Y},{type:N.mb,icon:X}],oe=a.memo(()=>{const n=v(o=>o.editor.previewType),e=b(),{t}=F();return r.jsxs("header",{className:w.header,children:[r.jsx("div",{className:w.left,children:t("editor.header")}),r.jsx("div",{className:w.middle,children:te.map(o=>r.jsx("span",{className:[w.icon,n===o.type&&w.selected].join(" "),onClick:()=>{e(C({previewType:o.type}))},children:r.jsx("img",{src:o.icon,alt:""})},o.type))}),r.jsx("div",{className:w.right,children:r.jsx(q,{})})]})}),z=()=>{let n,e;const t=new Promise((o,c)=>{n=(...m)=>{t.fullfilled=!0,t.pending=!1,o(...m)},e=(...m)=>{t.rejected=!0,c(...m)}});return t.resolve=n,t.reject=e,t.pending=!0,t};var d=(n=>(n.order="sectionConfigData.order",n.sections="sectionConfigData.sections",n.section="sectionConfigData.sections[sectionId]",n.sectionConfigData="sectionConfigData",n.currentEditingForm="currentEditingForm",n.language="language",n.themeSchemaChange="themeSchemaChange",n.themeConfigChange="themeConfigChange",n))(d||{}),L=(n=>(n.onAllSectionSchemaChange="on:allSectionSchemaChange",n.onSectionSchemaLanguage="on:sectionLanguageChange",n))(L||{});class ie{constructor(){x(this,"origin");x(this,"iframeWindowPromise");x(this,"eventListeners",new Map);this.origin=T(),this.iframeWindowPromise=z()}initFrameWindow(e){this.iframeWindowPromise.resolve(e);const t=o=>{if(console.log("Editor: 监听iframe发送的消息：",o.origin,this.origin,o.origin!==this.origin),this.origin&&o.origin!==this.origin){console.warn(`Message from unknown origin: ${o.origin}`);return}const{type:c,data:m}=o.data;if(this.eventListeners.has(c)){const h=this.eventListeners.get(c);h==null||h.forEach(u=>{u(m)})}};return window.addEventListener("message",t),()=>{this.iframeWindowPromise=z(),window.removeEventListener("message",t)}}async sendMessage(e,t){const o=await this.iframeWindowPromise,c={type:e,data:t};console.log("Editor: 给Iframe发送的消息：",c),o.contentWindow.postMessage(c,this.origin)}notifyThemeConfigChange(e){this.sendMessage(d.themeConfigChange,e)}notifyLanguageChange(e){this.sendMessage(d.language,e)}notifyCurrentEditingFormChange(e){this.sendMessage(d.currentEditingForm,e)}notifySectionConfigOrderChange(e){this.sendMessage(d.order,e)}notifySectionConfigSectionsChange(e){this.sendMessage(d.sections,e)}notifySectionConfigSectionChange(e,t){this.sendMessage(d.section,{sectionId:e,section:t})}notifySectionConfigDataChange(e){this.sendMessage(d.sectionConfigData,e)}onMessage(e,t){var o;return this.eventListeners.has(e)||this.eventListeners.set(e,[]),(o=this.eventListeners.get(e))==null||o.push(t),()=>{this.offMessage(e,t)}}onThemeSchemaChange(e){return this.onMessage(d.themeSchemaChange,e)}onThemeConfigChange(e){return this.onMessage(d.themeConfigChange,e)}onSectionConfigOrderChange(e){return this.onMessage(d.order,e)}onSectionConfigSectionsChange(e){return this.onMessage(d.sections,e)}onSectionConfigSectionChange(e){return this.onMessage(d.section,e)}onCurrentEditingFormChange(e){return this.onMessage(d.currentEditingForm,e)}onAllSectionSchemaChange(e){return this.onMessage(L.onAllSectionSchemaChange,e)}onSectionConfigData(e){return this.onMessage(d.sectionConfigData,e)}onSectionSchemaLanguage(e){return this.onMessage(L.onSectionSchemaLanguage,e)}offMessage(e,t){if(!this.eventListeners.has(e))return;const o=this.eventListeners.get(e);if(o){const c=o.indexOf(t);c!==-1&&o.splice(c,1)}}}const l=new ie,se="_preview_1dsqn_1",ae="_iframe_1dsqn_6",re="_pc_1dsqn_10",ce="_mobile_1dsqn_13",y={preview:se,iframe:ae,pc:re,mobile:ce},ge=a.memo(()=>{const n=v(h=>h.editor.previewType),{theme:e,themeStyle:t}=v(h=>h.editor),o=v(h=>h.global.language),c=a.useRef(null),m=W(e);return a.useEffect(()=>l.initFrameWindow(c.current),[m]),r.jsx("div",{className:y.preview,children:r.jsx("iframe",{ref:c,sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",className:[y.iframe,y[n]].join(" "),src:m+`?iseditor=1&themestyle=${t}&language=${o}`})})}),he=()=>{const n=b(),e=v(i=>i.editor.sectionConfigData),t=a.useRef(e);t.current=e;const o=a.useCallback((i,g=!0)=>{n(C({themeConfig:i})),g&&l.notifyThemeConfigChange(i)},[n]),c=a.useCallback((i,g=!0)=>{n(C({currentEditingForm:i})),g&&l.notifyCurrentEditingFormChange(i)},[n]),m=a.useCallback((i,g=!0)=>{n(E({...t.current,order:i})),g&&l.notifySectionConfigOrderChange(i)},[n]),h=a.useCallback((i,g=!0)=>{n(E(i)),g&&l.notifySectionConfigDataChange(i)},[n]),u=a.useCallback((i,g=!0)=>{n(E({...t.current,sections:i})),g&&l.notifySectionConfigSectionsChange(i)},[n]),f=a.useCallback((i,g,S=!0)=>{const s={...t.current,sections:{...t.current.sections,[i]:g}};n(E(s)),S&&l.notifySectionConfigSectionChange(i,g)},[n]),_=a.useCallback((i,g)=>{const s=t.current.sections[i],A={...s,settingsData:{...s.settingsData,block_order:g}};f(i,A)},[f]),M=a.useCallback((i,g,S)=>{const A=t.current.sections[i],D={...A,settingsData:{...A.settingsData,blocks:{...A.settingsData.blocks}}};S?D.settingsData.blocks[g]=S:(D.settingsData.block_order=D.settingsData.block_order.filter(P=>P!==g),D.settingsData.blocks[g]=void 0),f(i,D)},[f]);return{updateSectionConfigOrder:m,updateSectionConfigSections:u,updateSectionConfigSectionBySectionId:f,updateAllSectionConfigData:h,updateCurrentEditingForm:c,updateBlockConfigData:M,updateBlockOrderData:_,updateThemeConfig:o}},le=()=>{const n=b(),{updateSectionConfigOrder:e,updateSectionConfigSections:t,updateSectionConfigSectionBySectionId:o,updateAllSectionConfigData:c}=he();a.useEffect(()=>{const m=l.onThemeConfigChange(s=>{n(C({themeConfig:s}))}),h=l.onThemeSchemaChange(s=>{n(C({themeSchema:s}))}),u=l.onCurrentEditingFormChange(s=>{n(C({currentEditingForm:s}))}),f=l.onAllSectionSchemaChange(s=>{n(C({allSectionSchema:s}))}),_=l.onSectionConfigData(s=>{c(s,!1)}),M=l.onSectionConfigOrderChange(s=>{e(s,!1)}),i=l.onSectionConfigSectionChange(({sectionId:s,section:A})=>{o(s,A,!1)}),g=l.onSectionConfigSectionsChange(s=>{t(s,!1)}),S=l.onSectionSchemaLanguage(s=>{k.addResourceBundle(s.i18nKey,O,s.locales,!0,!0),k.changeLanguage(s.i18nKey)});return()=>{f(),_(),M(),i(),g(),S(),u(),h(),m()}},[n,c,e,o,t])},fe="_editor_17x41_1",de="_main_17x41_7",me="_sidebar_17x41_13",Ce="_iconwrap_17x41_18",ue="_selected_17x41_33",Se="_notfound_17x41_51",Ae="_back_17x41_58",p={editor:fe,main:de,sidebar:me,iconwrap:Ce,selected:ue,notfound:Se,back:Ae},pe=a.lazy(()=>B(()=>import("./index-Ba8jslA9.js"),__vite__mapDeps([0,1,2,3,4,5]))),ve=a.lazy(()=>B(()=>import("./index-Cccog60T.js"),__vite__mapDeps([6,1,2,3,7,8,9,10,11]))),we=a.lazy(()=>B(()=>import("./index-CsiBAcyk.js"),__vite__mapDeps([12,1,2,3,10,4,13]))),_e=[{type:j.comp,icon:G},{type:j.theme,icon:Q}],De=a.memo(()=>{const{t:n}=F(),e=v(f=>f.editor.sideBarType),t=v(f=>f.global.language),o=b(),[c]=V(),m=H(),h=c.get("theme"),u=c.get("themestyle");return a.useEffect(()=>{l.notifyLanguageChange(t),h&&o(C({theme:h})),u&&o(C({themeStyle:u}))},[o,t,h,u]),le(),a.useEffect(()=>()=>{o(I())},[o]),h?r.jsxs("div",{className:p.editor,children:[r.jsx(oe,{}),r.jsxs("div",{className:p.main,children:[r.jsx("div",{className:p.sidebar,children:_e.map(f=>{const _=f.icon;return r.jsx("span",{onClick:()=>{o(C({sideBarType:f.type}))},className:[p.iconwrap,e===f.type&&p.selected].join(" "),children:r.jsx(_,{})},f.type)})}),e===j.comp&&r.jsx(ve,{}),e===j.theme&&r.jsx(we,{}),r.jsx(ge,{}),r.jsx(pe,{})]})]}):r.jsxs("div",{className:p.notfound,children:[r.jsx("span",{children:n("editor.notfoundtheme")}),r.jsx("span",{className:p.back,onClick:()=>{m("/")},children:n("editor.backhome")})]})}),be=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));export{be as i,he as u};
