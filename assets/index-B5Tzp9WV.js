import{r as n,R as y}from"./index-C5A3sSgy.js";import{ar as U,as as F,s as R,ae as H,e as x,z as W,C as N,a1 as V,U as G,at as M,au as J,av as K}from"./constant-CPvBHiUR.js";import{c as Q}from"./reactNode-DEFrIjqh.js";import{g as X}from"./UnstableContext-B1-DvSwI.js";const Y=e=>{const{componentCls:o,colorPrimary:t}=e;return{[o]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${t})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${e.motionDurationSlow} ${e.motionEaseInOut}`,`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`].join(",")}}}}},Z=U("Wave",e=>[Y(e)]),T=`${F}-wave-target`;function g(e){return e&&e!=="#fff"&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&e!=="rgba(255, 255, 255, 1)"&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&e!=="transparent"}function ee(e){const{borderTopColor:o,borderColor:t,backgroundColor:r}=getComputedStyle(e);return g(o)?o:g(t)?t:g(r)?r:null}function S(e){return Number.isNaN(e)?0:e}const te=e=>{const{className:o,target:t,component:r,registerUnmount:i}=e,c=n.useRef(null),l=n.useRef(null);n.useEffect(()=>{l.current=i()},[]);const[d,C]=n.useState(null),[f,s]=n.useState([]),[v,p]=n.useState(0),[$,L]=n.useState(0),[k,O]=n.useState(0),[z,A]=n.useState(0),[D,I]=n.useState(!1),w={left:v,top:$,width:k,height:z,borderRadius:f.map(u=>`${u}px`).join(" ")};d&&(w["--wave-color"]=d);function E(){const u=getComputedStyle(t);C(ee(t));const a=u.position==="static",{borderLeftWidth:m,borderTopWidth:b}=u;p(a?t.offsetLeft:S(-parseFloat(m))),L(a?t.offsetTop:S(-parseFloat(b))),O(t.offsetWidth),A(t.offsetHeight);const{borderTopLeftRadius:h,borderTopRightRadius:j,borderBottomLeftRadius:q,borderBottomRightRadius:B}=u;s([h,j,B,q].map(P=>S(parseFloat(P))))}if(n.useEffect(()=>{if(t){const u=R(()=>{E(),I(!0)});let a;return typeof ResizeObserver<"u"&&(a=new ResizeObserver(E),a.observe(t)),()=>{R.cancel(u),a==null||a.disconnect()}}},[]),!D)return null;const _=(r==="Checkbox"||r==="Radio")&&(t==null?void 0:t.classList.contains(T));return n.createElement(H,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(u,a)=>{var m,b;if(a.deadline||a.propertyName==="opacity"){const h=(m=c.current)===null||m===void 0?void 0:m.parentElement;(b=l.current)===null||b===void 0||b.call(l).then(()=>{h==null||h.remove()})}return!1}},(u,a)=>{let{className:m}=u;return n.createElement("div",{ref:W(c,a),className:x(o,m,{"wave-quick":_}),style:w})})},oe=(e,o)=>{var t;const{component:r}=o;if(r==="Checkbox"&&!(!((t=e.querySelector("input"))===null||t===void 0)&&t.checked))return;const i=document.createElement("div");i.style.position="absolute",i.style.left="0px",i.style.top="0px",e==null||e.insertBefore(i,e==null?void 0:e.firstChild);const c=X();let l=null;function d(){return l}l=c(n.createElement(te,Object.assign({},o,{target:e,registerUnmount:d})),i)},ne=(e,o,t)=>{const{wave:r}=n.useContext(N),[,i,c]=V(),l=G(f=>{const s=e.current;if(r!=null&&r.disabled||!s)return;const v=s.querySelector(`.${T}`)||s,{showEffect:p}=r||{};(p||oe)(v,{className:o,token:i,component:t,event:f,hashId:c})}),d=n.useRef(null);return f=>{R.cancel(d.current),d.current=R(()=>{l(f)})}},ce=e=>{const{children:o,disabled:t,component:r}=e,{getPrefixCls:i}=n.useContext(N),c=n.useRef(null),l=i("wave"),[,d]=Z(l),C=ne(c,x(l,d),r);if(y.useEffect(()=>{const s=c.current;if(!s||s.nodeType!==1||t)return;const v=p=>{!K(p.target)||!s.getAttribute||s.getAttribute("disabled")||s.disabled||s.className.includes("disabled")||s.className.includes("-leave")||C(p)};return s.addEventListener("click",v,!0),()=>{s.removeEventListener("click",v,!0)}},[t]),!y.isValidElement(o))return o??null;const f=M(o)?W(J(o),c):c;return Q(o,{ref:f})};export{ce as W};
